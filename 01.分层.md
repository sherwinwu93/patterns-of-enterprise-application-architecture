
### 第一部分
### 第1章 分层
分层的观点来考虑系统,下层系统对上层系统使用其服务义务所知,每一层对自己的上层隐藏自己下层的细节.

分层的好处:
1. 无需过多了解其他层次的基础上,可以将某一层作为一个有机整体来理解.例如:无需知道以太网的工作细节,照样可以在TCP上构建FTP服务.
2. 可以替换某层的具体实现,只要前后提供的服务相同即可.
3. 可以将层次间的依赖降到最低.
4. 分层有利于标准化工作.
5. 一旦构建好某一层次,就可以用它为很多上层服务提供支持.

分层的缺陷:
1. 层次不能分装所有东西,有时会为我们带来级联修改.
2. 过多的层级会影响性能.

分层架构中最困难的问题是决定建立哪些层次以及每一层的职责是什么.

#### 1.1 企业应用中层次的演化
批处理系统时期: 无需关注层次

客户/服务器系统时期: 客户端包括用户界面和其他应用代码,服务器端通常是关系型数据库.<br/>
产生的问题: 来自领域逻辑: 如业务规则、验证、计算等.随着领域逻辑不断复杂化,直接写入用户界面,代码会越来越难以使用.<br/>
另一种方法,将领域逻辑放到数据库端,作为存储过程.

面向对象时期: 三层架构.表现层实现用户界面,在领域层实现领域逻辑,在数据层存取数据.这种方式可以将复杂的领域逻辑从界面代码中抽取出
来,单独放到中间层,用对象加以建模和组织.

#### 1.2 三个基本层次
1. 表现层: 提供服务,显示信息(在Windows或HTML页面中,处理用户请求(鼠标点击、键盘敲击等)),HTTP请求,命令行调用,批处理API)
2. 领域层: 逻辑,系统中真正的核心
3. 数据源层: 与数据库、消息系统、事务管理器及其他软件包通信

为别人提供服务的接口与使用别人服务的接口存在较大的差异,需要明确区分.这就是表现层和数据源层相对于核心的本质区别.表现层是系统对外
提供服务的外部接口,不管外面是复杂的人类还是一个简单的远端程序.数据源层是系统使用外部服务的接口.

根据不同的问题,选择一种适合的分离方式,但是切记一定要进行某种形式的分离--至少在子程序级别.

伴随着分离,还有一条关于依赖性的普遍原则: 领域层和数据源层绝对不要依赖于表现层.

使用领域逻辑时,其中一个最困难的部分就是区分什么是领域逻辑,什么是其他逻辑.一种不太正规的测试办法是:假想想系统中增加一个完全不太的
锌层,例如为Web应用增加一个命令行界面层.如果在这个过程中,发现需要重复实现某些功能,则说明可能有一些本应该在领域层实现的逻辑,现在
在表现层实现了.类似地,可以假想将后台数据库更换成XML文件格式.

#### 1.3 为各层选择运行环境
逻辑层次--将系统中各部分分离,以降低不同部分之间的耦合程度.
